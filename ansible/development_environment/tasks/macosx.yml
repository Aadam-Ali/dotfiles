---
- name: Update Homebrew & Packages
  community.general.homebrew:
    update_homebrew: true
    upgrade_all: true

- name: Install Standard Packages
  community.general.homebrew:
    name: "{{ common_pkgs + os_pkgs }}"
    state: present

- name: Install Pyenv Dependencies
  community.general.homebrew:
    name: "{{ pyenv_deps }}"
    state: present

- name: Install Docker
  community.general.homebrew:
    name: "{{ docker_pkgs }}"
    state: present

- name: Upgrade Homebrew Casks
  community.general.homebrew_cask:
    upgrade_all: true

- name: Install Casks
  community.general.homebrew_cask:
    name: "{{ casks }}"
    state: present

- name: Create Font Dirs
  ansible.builtin.file:
    path: "{{ ansible_env['HOME'] }}/Library/Fonts/{{ item.key }}"
    state: directory
  loop: "{{ fonts | dict2items }}"

- name: Install Fonts
  ansible.builtin.unarchive:
    creates: "{{ ansible_env['HOME'] }}/Library/Fonts/{{ item.key }}/README.md"
    src: "{{ item.value }}"
    dest: "{{ ansible_env['HOME'] }}/Library/Fonts/{{ item.key }}"
    remote_src: yes
  loop: "{{ fonts | dict2items }}"
